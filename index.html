<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ramadan Tracker</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --accent: #d4af37;
            --green: #27ae60;
            --red: #e74c3c;
            --bg-color: #000000;
            --card-bg: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
            --text-white: #ffffff;
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
            /* –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞, –∫—Ä–æ–º–µ input */
            -webkit-user-select: none;
            user-select: none;
        }

        input, textarea {
            -webkit-user-select: text !important;
            user-select: text !important;
        }

        body {
            background-color: var(--bg-color) !important;
            color: var(--text-white) !important;
            font-family: 'Manrope', sans-serif;
            margin: 0; padding: 0; 
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* –§–û–ù (–ó–í–ï–ó–î–´) */
        #star-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(180deg, #090e16 0%, #000000 100%);
            z-index: 0; pointer-events: none; overflow: hidden;
        }
        
        .star-layer {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            animation: moveStars 100s linear infinite;
        }
        .star-layer:nth-child(2) { animation-duration: 150s; opacity: 0.6; }

        .stars-1 {
            width: 2px; height: 2px; background: transparent;
            box-shadow: 10vw 10vh #fff, 20vw 50vh #fff, 30vw 20vh #fff, 80vw 80vh #fff, 90vw 10vh #fff, 50vw 50vh #fff, 15vw 90vh #fff;
            filter: drop-shadow(0 0 2px white);
        }
        .stars-2 {
            width: 3px; height: 3px; background: transparent;
            box-shadow: 55vw 15vh #fff, 25vw 85vh #fff, 75vw 25vh #fff, 10vw 60vh #fff;
            filter: drop-shadow(0 0 4px white);
        }
        
        @keyframes moveStars {
            from { transform: translateY(0); }
            to { transform: translateY(-100px); }
        }

        .container { 
            max-width: 450px; margin: 0 auto; padding: 20px; padding-bottom: 140px; 
            position: relative; z-index: 10; 
        }

        /* –ö–ù–û–ü–ö–ò */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .btn-mini {
            background: rgba(255, 255, 255, 0.1); color: #fff; padding: 10px 16px; border-radius: 12px;
            font-size: 13px; font-weight: 600; border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer; backdrop-filter: blur(10px); font-family: 'Manrope', sans-serif; transition: 0.2s;
            position: relative; z-index: 20;
        }
        .btn-mini:active { transform: scale(0.95); background: rgba(255, 255, 255, 0.2); }

        .brand-link {
            display: block; text-align: center; font-size: 12px; color: var(--accent);
            text-decoration: none; font-weight: 600; margin-bottom: 25px; opacity: 0.8; letter-spacing: 0.5px;
            position: relative; z-index: 20;
        }

        /* –ì–õ–ê–í–ù–´–ô –ö–†–£–ì */
        .progress-header { display: flex; flex-direction: column; align-items: center; margin-bottom: 20px; position: relative; z-index: 11; }
        .circle-wrapper { display: flex; justify-content: center; align-items: center; gap: 20px; margin-bottom: 20px; }
        .nav-arrow { font-size: 28px; color: #666; padding: 10px; cursor: pointer; transition: 0.2s; position: relative; z-index: 20; }
        .nav-arrow.disabled { opacity: 0.2; pointer-events: none; }
        
        .circle-container { position: relative; width: 160px; height: 160px; }
        svg { transform: rotate(-90deg); width: 100%; height: 100%; }
        circle { fill: none; stroke-width: 8; stroke-linecap: round; }
        .circle-bg { stroke: rgba(255, 255, 255, 0.1); }
        .circle-progress { 
            stroke: var(--red); stroke-dasharray: 440; stroke-dashoffset: 440; 
            transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1), stroke 0.6s ease; 
            filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.1)); 
        }
        
        .day-info { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .day-number { font-size: 42px; font-weight: 800; line-height: 1; color: #fff; text-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .day-label { font-size: 12px; color: #aaa; text-transform: uppercase; font-weight: 600; letter-spacing: 1px; }
        .greeting-text { text-align: center; font-size: 14px; color: #ccc; line-height: 1.5; max-width: 280px; margin: 0 auto; font-weight: 500; opacity: 0.9; }

        /* –°–¢–ê–¢–£–° */
        #syncStatus { font-size: 11px; text-align: center; color: #666; height: 20px; line-height: 20px; margin-bottom: 15px; position: relative; z-index: 10; font-weight: 600; transition: color 0.3s; }
        #syncStatus.active { color: var(--green); }

        /* –°–ü–ò–°–ö–ò –ò –ó–ê–î–ê–ß–ò */
        .tracker-section { background: var(--card-bg); border-radius: 24px; padding: 22px; margin-bottom: 16px; border: 1px solid var(--border); backdrop-filter: blur(5px); position: relative; z-index: 11; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .section-title { font-size: 17px; font-weight: 800; color: var(--accent); display: flex; align-items: center; gap: 8px;}
        .section-percent { font-size: 13px; color: #888; font-weight: 600; font-variant-numeric: tabular-nums; }
        .progress-bar-bg { width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 4px; margin-bottom: 15px; overflow: hidden; }
        .progress-bar-fill { height: 100%; width: 0%; background: var(--accent); border-radius: 4px; transition: width 0.3s ease, background-color 0.3s ease; }
        .group-label { font-size: 11px; text-transform: uppercase; color: #666; font-weight: 700; margin-top: 18px; margin-bottom: 10px; letter-spacing: 1px; }
        .task-item { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid rgba(255,255,255,0.08); cursor: pointer; }
        .task-item:last-child { border-bottom: none; }
        .task-text { font-size: 15px; font-weight: 500; color: #eee; }
        .checkbox { width: 26px; height: 26px; border-radius: 8px; border: 2px solid #444; display: flex; align-items: center; justify-content: center; transition: all 0.2s; background: transparent; }
        .task-item.checked .checkbox { background: var(--accent); border-color: var(--accent); box-shadow: 0 0 10px rgba(212, 175, 55, 0.4); }
        .checkbox::after { content: '‚úì'; font-size: 18px; display: none; font-weight: 800; color: #000; }
        .task-item.checked .checkbox::after { display: block; }
        
        .custom-input { border: 1px solid #333; background: rgba(255,255,255,0.05); padding: 14px; border-radius: 12px; font-size: 15px; width: 100%; margin-right: 12px; color: #fff; outline: none; font-family: 'Manrope', sans-serif; position: relative; z-index: 12; }
        .custom-row { display: flex; align-items: center; justify-content: space-between; margin-top: 10px; }
        .stars { display: flex; justify-content: center; gap: 10px; margin-top: 10px; }
        .star { font-size: 32px; color: #333; cursor: pointer; transition: color 0.2s; position: relative; z-index: 20;}
        .star.active { color: var(--accent); text-shadow: 0 0 10px rgba(212, 175, 55, 0.5); }
        .journal-area { width: 100%; height: 100px; background: rgba(0,0,0,0.3); border: 1px solid #333; border-radius: 12px; padding: 15px; color: #fff; font-family: 'Manrope', sans-serif; font-size: 14px; resize: none; outline: none; margin-top: 5px; transition: 0.3s; position: relative; z-index: 12; }
        .journal-area:focus { border-color: var(--accent); }

        /* –ù–ò–ñ–ù–ò–ï –ö–ù–û–ü–ö–ò */
        .bottom-actions {
            display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px;
        }
        .btn-finish { 
            background: #fff; color: #000; width: 100%; padding: 18px; border: none; border-radius: 16px; 
            font-size: 14px; font-weight: 800; cursor: pointer; text-transform: uppercase; 
            font-family: 'Manrope', sans-serif; box-shadow: 0 0 20px rgba(255, 255, 255, 0.1); 
            position: relative; z-index: 50; transition: background 0.3s;
        }
        .btn-finish.saved {
            background: var(--green); color: white;
        }
        .btn-share {
            background: #222; border: 1px solid #333; border-radius: 16px; color: #fff;
            font-size: 14px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center;
            text-transform: uppercase; position: relative; z-index: 50;
        }
        .btn-share:active, .btn-finish:active { transform: scale(0.96); }

        /* –ú–û–î–ê–õ–ö–ò */
        .modal-overlay { 
            position: fixed; bottom: 0; left: 0; width: 100%; height: 95vh; background: #161616; 
            border-top-left-radius: 28px; border-top-right-radius: 28px; 
            box-shadow: 0 -10px 50px rgba(0,0,0,0.8); transform: translateY(110%); 
            transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); 
            z-index: 200; display: flex; flex-direction: column; border-top: 1px solid #333; 
        }
        .modal-overlay.show { transform: translateY(0); }
        .modal-header { padding: 20px; text-align: center; border-bottom: 1px solid #252525; position: relative; flex-shrink: 0; }
        .modal-title { font-size: 18px; font-weight: 700; color: white; }
        .close-modal { position: absolute; top: 20px; right: 20px; font-size: 24px; cursor: pointer; color: #666; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; }
        .modal-content { flex: 1; overflow-y: auto; padding: 20px; color: white; }

        /* –ö–ê–†–¢–û–ß–ö–ê –®–ê–†–ò–ù–ì–ê */
        .share-card-container {
            width: 100%; padding-bottom: 120%; position: relative;
            background: linear-gradient(135deg, #1a2a40 0%, #000000 100%);
            border-radius: 24px; border: 1px solid #333; overflow: hidden;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
        .share-content {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; text-align: center;
        }
        .share-date { font-size: 14px; text-transform: uppercase; letter-spacing: 2px; color: #888; margin-bottom: 15px; }
        .share-circle-wrap { width: 120px; height: 120px; position: relative; margin-bottom: 15px; }
        .share-day-num { font-size: 48px; font-weight: 800; color: #fff; }
        .share-ai-text { font-size: 15px; line-height: 1.4; color: #eee; font-style: italic; max-width: 90%; margin-bottom: 20px; }
        
        .share-branding { position: absolute; bottom: 20px; left: 0; width: 100%; text-align: center; }
        .share-branding-text { font-size: 11px; color: var(--accent); font-weight: 800; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
        .share-branding-sub { font-size: 10px; color: #666; }
        
        .btn-send-image {
            width: 100%; padding: 16px; background: var(--accent); color: black; font-weight: 800; 
            border-radius: 12px; border: none; margin-top: 10px; text-transform: uppercase;
            font-family: 'Manrope', sans-serif; cursor: pointer;
        }
        
        /* –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –ì–û–¢–û–í–û–ô –ö–ê–†–¢–ò–ù–ö–ò */
        #generatedImageContainer {
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid #333;
            margin-bottom: 20px;
            display: none;
        }
        
        /* –°–¢–ò–õ–¨ –î–õ–Ø –°–ê–ú–û–ô –ö–ê–†–¢–ò–ù–ö–ò (–ß—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ) */
        #generatedImageContainer img {
            width: 100%;
            display: block;
            pointer-events: auto !important; /* –†–∞–∑—Ä–µ—à–∞–µ–º –∫–ª–∏–∫–∏ */
            -webkit-user-select: none; /* –ó–∞–ø—Ä–µ—â–∞–µ–º –≤—ã–¥–µ–ª—è—Ç—å –∫–∞–∫ —Ç–µ–∫—Å—Ç */
            -webkit-touch-callout: default !important; /* –†–∞–∑—Ä–µ—à–∞–µ–º –º–µ–Ω—é iOS */
        }

        /* –ö–ê–õ–ï–ù–î–ê–†–¨ –ò –û–¢–ß–ï–¢–´ */
        .city-list { display: flex; flex-direction: column; gap: 10px; }
        .city-item { padding: 15px; background: #222; border-radius: 12px; cursor: pointer; border: 1px solid #333; transition: 0.2s; display: flex; justify-content: space-between; }
        .cal-disclaimer { font-size: 12px; color: #888; text-align: center; margin-bottom: 15px; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; line-height: 1.4; }
        .prayer-table-container { overflow-x: auto; margin-bottom: 20px; }
        .prayer-table { width: 100%; border-collapse: collapse; min-width: 500px; }
        .prayer-table th { text-align: left; font-size: 11px; color: #666; text-transform: uppercase; padding: 10px; border-bottom: 1px solid #333; }
        .prayer-table td { padding: 12px 10px; font-size: 13px; border-bottom: 1px solid #222; }
        .prayer-table tr.today-row { background: rgba(212, 175, 55, 0.1); }
        .change-city-btn {
            width: 100%; padding: 16px; background: #222; color: #fff;
            border: 1px solid #444; border-radius: 14px;
            font-size: 14px; font-weight: 700; cursor: pointer;
            font-family: 'Manrope', sans-serif; transition: 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 25px; }
        .stat-card { background: rgba(255,255,255,0.05); padding: 15px; border-radius: 16px; text-align: center; border: 1px solid #333; }
        .stat-num { font-size: 24px; font-weight: 800; color: var(--accent); margin-bottom: 4px; }
        .stat-desc { font-size: 11px; color: #aaa; font-weight: 600; text-transform: uppercase; }
        .author-links { text-align: center; margin-top: 20px; }
        .author-btn { 
            display: block; width: 100%; text-align: center; padding: 12px; 
            background: #222; border-radius: 12px; color: #888; text-decoration: none; 
            font-size: 13px; font-weight: 600; border: 1px solid #333; margin-bottom: 10px; 
        }
    </style>
</head>
<body>

<div id="star-bg">
    <div class="star-layer stars-1"></div>
    <div class="star-layer stars-2"></div>
</div>

<div class="container">
    <div class="top-bar">
        <button class="btn-mini" id="btnStats">üìä –ú–æ–π –û—Ç—á–µ—Ç</button>
        <button class="btn-mini" id="btnCalendar">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
    </div>

    <a href="https://t.me/ametov_design" class="brand-link" target="_blank">
        –¢—Ä–µ–∫–µ—Ä –ê–∑–∏–∑–∞ –ê–º–µ—Ç–æ–≤–∞ ‚Üó
    </a>

    <div class="progress-header">
        <div class="circle-wrapper">
            <div class="nav-arrow" id="prevDay">‚ùÆ</div>
            <div class="circle-container">
                <svg viewBox="0 0 160 160">
                    <circle class="circle-bg" cx="80" cy="80" r="70"></circle>
                    <circle class="circle-progress" id="monthCircle" cx="80" cy="80" r="70"></circle>
                </svg>
                <div class="day-info">
                    <div class="day-number" id="uiDayNum">1</div>
                    <div class="day-label" id="uiDayLabel">–î–µ–Ω—å</div>
                </div>
            </div>
            <div class="nav-arrow disabled" id="nextDay">‚ùØ</div>
        </div>
        
        <div class="greeting-text">
            –ê—Å—Å–∞–ª—è–º—É –∞–ª–µ–π–∫—É–º, –¥–∞–≤–∞–π –ø—Ä–æ–≤–µ–¥–µ–º<br>—ç—Ç–æ—Ç –º–µ—Å—è—Ü –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–∫–∞—Ö?
        </div>
    </div>

    <div id="syncStatus">–ó–∞–≥—Ä—É–∑–∫–∞...</div>

    <div class="tracker-section">
        <div class="section-header">
            <div class="section-title">ü§≤ –ù–∞–º–∞–∑</div>
            <div class="section-percent">0%</div>
        </div>
        <div class="progress-bar-bg"><div class="progress-bar-fill"></div></div>

        <div class="group-label">–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ</div>
        <div class="task-item" onclick="toggleTask(this, 'fajr')"><span class="task-text">–§–∞–¥–∂—Ä</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'dhuhr')"><span class="task-text">–ó—É—Ö—Ä</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'asr')"><span class="task-text">–ê—Å—Ä</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'maghrib')"><span class="task-text">–ú–∞–≥—Ä–∏–±</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'isha')"><span class="task-text">–ò—à–∞</span><div class="checkbox"></div></div>
        <div class="group-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ</div>
        <div class="task-item" onclick="toggleTask(this, 'sunnah')"><span class="task-text">–°—É–Ω–Ω—ã</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'tarawih')"><span class="task-text">–¢–∞—Ä–∞–≤–∏—Ö</span><div class="checkbox"></div></div>
    </div>

    <div class="tracker-section">
        <div class="section-header">
            <div class="section-title">üìñ –ö–æ—Ä–∞–Ω</div>
            <div class="section-percent">0%</div>
        </div>
        <div class="progress-bar-bg"><div class="progress-bar-fill"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'quran_read')"><span class="task-text">–ß—Ç–µ–Ω–∏–µ –ö–æ—Ä–∞–Ω–∞</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'arabic')"><span class="task-text">–ò–∑—É—á–µ–Ω–∏–µ –∞—Ä–∞–±—Å–∫–æ–≥–æ</span><div class="checkbox"></div></div>
    </div>

    <div class="tracker-section">
        <div class="section-header">
            <div class="section-title">ü•ó –ü–∏—Ç–∞–Ω–∏–µ</div>
            <div class="section-percent">0%</div>
        </div>
        <div class="progress-bar-bg"><div class="progress-bar-fill"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'suhoor_wakeup')"><span class="task-text">–ü—Ä–æ—Å–Ω—É–ª—Å—è –Ω–∞ —Å—É—Ö—É—Ä</span><div class="checkbox"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'no_overeat')"><span class="task-text">–°–µ–≥–æ–¥–Ω—è –Ω–µ –ø–µ—Ä–µ–µ–ª</span><div class="checkbox"></div></div>
    </div>

    <div class="tracker-section">
        <div class="section-header">
            <div class="section-title">‚ú® –õ–∏—á–Ω–æ—Å—Ç—å</div>
            <div class="section-percent">0%</div>
        </div>
        <div class="progress-bar-bg"><div class="progress-bar-fill"></div></div>
        <div class="task-item" onclick="toggleTask(this, 'no_gossip')"><span class="task-text">–ù–µ —Å–ø–ª–µ—Ç–Ω–∏—á–∞–ª</span><div class="checkbox"></div></div>
        <div class="group-label">–ú–æ—è —Ü–µ–ª—å</div>
        <div class="custom-row">
            <input type="text" class="custom-input" id="customInput" placeholder="–í–ø–∏—à–∏ —Ü–µ–ª—å..." oninput="saveCustomText()">
            <div class="task-item" onclick="toggleTask(this, 'custom_goal')" style="border:none; padding:0;"><div class="checkbox"></div></div>
        </div>
    </div>

    <div class="tracker-section">
        <div class="section-title">üìù –ú—ã—Å–ª–∏ –∑–∞ –¥–µ–Ω—å</div>
        <textarea id="dailyThoughts" class="journal-area" placeholder="–ß—Ç–æ —Å–µ–≥–æ–¥–Ω—è –æ—Å–æ–∑–Ω–∞–ª? –ó–∞ —á—Ç–æ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω?..." oninput="saveThoughts()"></textarea>
    </div>

    <div class="tracker-section">
        <div class="section-title" style="justify-content:center;">‚≠ê –û—Ü–µ–Ω–∫–∞ –¥–Ω—è</div>
        <div class="stars">
            <div class="star" data-val="1">‚òÖ</div>
            <div class="star" data-val="2">‚òÖ</div>
            <div class="star" data-val="3">‚òÖ</div>
            <div class="star" data-val="4">‚òÖ</div>
            <div class="star" data-val="5">‚òÖ</div>
        </div>
    </div>

    <div class="bottom-actions">
        <button class="btn-finish" id="btnFinish">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn-share" id="btnShare">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –¥–Ω—ë–º</button>
    </div>
</div>

<div class="modal-overlay" id="modalCalendar">
    <div class="modal-header">
        <div class="modal-title" id="calTitle">üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</div>
        <div class="close-modal" onclick="closeModal('modalCalendar')">√ó</div>
    </div>
    <div class="modal-content" id="calContent"></div>
</div>

<div class="modal-overlay" id="modalStats">
    <div class="modal-header">
        <div class="modal-title">üìä –¢–≤–æ–π –û—Ç—á–µ—Ç</div>
        <div class="close-modal" onclick="closeModal('modalStats')">√ó</div>
    </div>
    <div class="modal-content">
        <div class="stat-grid">
            <div class="stat-card"><div class="stat-num" id="statDays">0</div><div class="stat-desc">–î–Ω–µ–π –ø—Ä–æ–π–¥–µ–Ω–æ</div></div>
            <div class="stat-card"><div class="stat-num" id="statRating">0.0</div><div class="stat-desc">–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</div></div>
            <div class="stat-card"><div class="stat-num" id="statQuran">0</div><div class="stat-desc">–ß–∏—Ç–∞–ª –ö–æ—Ä–∞–Ω (–¥–Ω–µ–π)</div></div>
            <div class="stat-card"><div class="stat-num" id="statNamaz">0</div><div class="stat-desc">–ü–æ–ª–Ω—ã—Ö –¥–Ω–µ–π –Ω–∞–º–∞–∑–∞</div></div>
        </div>
        <div class="ai-feedback">
            <div class="ai-title">ü§ñ –ú–Ω–µ–Ω–∏–µ —Ç—Ä–µ–∫–µ—Ä–∞</div>
            <div class="ai-text" id="aiText">...</div>
        </div>
        <div class="author-links">
            <a href="https://t.me/ametovstudio" target="_blank" class="author-btn">Telegram: @ametovstudio</a>
            <a href="https://instagram.com/ametovstudio" target="_blank" class="author-btn">Instagram: @ametovstudio</a>
        </div>
    </div>
</div>

<div class="modal-overlay" id="modalShare">
    <div class="modal-header">
        <div class="modal-title">üì∏ –ü–æ–¥–µ–ª–∏—Å—å —É—Å–ø–µ—Ö–æ–º</div>
        <div class="close-modal" onclick="closeModal('modalShare')">√ó</div>
    </div>
    <div class="modal-content" style="display:flex; flex-direction:column; align-items:center;">
        
        <div class="share-card-container" id="shareCardToRender">
            <div class="share-content">
                <div class="share-date" id="shareDate">...</div>
                
                <div class="share-circle-wrap">
                     <svg viewBox="0 0 160 160" style="width:100%; height:100%; transform: rotate(-90deg);">
                        <circle class="circle-bg" cx="80" cy="80" r="70" style="stroke-width:8;"></circle>
                        <circle id="shareCircle" stroke="#d4af37" stroke-width="8" fill="none" cx="80" cy="80" r="70" stroke-linecap="round" stroke-dasharray="440" stroke-dashoffset="440"></circle>
                    </svg>
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center;">
                        <div class="share-day-num" id="shareDayNum">1</div>
                        <div style="font-size:10px; color:#aaa; text-transform:uppercase;">–î–ï–ù–¨</div>
                    </div>
                </div>

                <div class="share-ai-text" id="shareAiText">...</div>
                <div class="stars" id="shareStars"></div>

                <div class="share-branding">
                    <div class="share-branding-text">–¢—Ä–µ–∫–µ—Ä –†–∞–º–∞–¥–∞–Ω –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–∫–∞—Ö</div>
                    <div class="share-branding-sub">–æ—Ç –ê–∑–∏–∑–∞ –ê–º–µ—Ç–æ–≤–∞</div>
                </div>
            </div>
        </div>

        <div id="generatedImageContainer"></div>

        <button class="btn-send-image" id="btnGenImage" onclick="generateAndSend()">–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É</button>
        <p style="text-align:center; font-size:12px; color:#666; margin-top:10px;" id="shareHint">
            –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ—Ç–æ
        </p>

    </div>
</div>

<script>
    let tg = window.Telegram ? window.Telegram.WebApp : null;
    if (tg) { tg.expand(); tg.MainButton.hide(); tg.setHeaderColor('#090e16'); tg.setBackgroundColor('#000000'); }

    const CITIES = [
        { id:0, name: "–ú–æ—Å–∫–≤–∞", fajr_base: 5, maghrib_base: 17, min_shift: 2 }, 
        { id:1, name: "–ö–∞–∑–∞–Ω—å", fajr_base: 5, maghrib_base: 16, min_shift: 2 },
        { id:2, name: "–ì—Ä–æ–∑–Ω—ã–π", fajr_base: 5, maghrib_base: 17, min_shift: 1 },
        { id:3, name: "–ú–∞—Ö–∞—á–∫–∞–ª–∞", fajr_base: 5, maghrib_base: 17, min_shift: 1 },
        { id:4, name: "–£—Ñ–∞", fajr_base: 6, maghrib_base: 18, min_shift: 2 },
        { id:5, name: "–°–∏–º—Ñ–µ—Ä–æ–ø–æ–ª—å", fajr_base: 6, maghrib_base: 17, min_shift: 1 },
        { id:6, name: "–¢–∞—à–∫–µ–Ω—Ç", fajr_base: 5, maghrib_base: 18, min_shift: 1 },
        { id:7, name: "–ê–ª–º–∞—Ç—ã", fajr_base: 6, maghrib_base: 18, min_shift: 1 },
        { id:8, name: "–ê—Å—Ç–∞–Ω–∞", fajr_base: 6, maghrib_base: 18, min_shift: 2 },
        { id:9, name: "–ë–∏—à–∫–µ–∫", fajr_base: 6, maghrib_base: 18, min_shift: 1 },
        { id:10, name: "–î—É—à–∞–Ω–±–µ", fajr_base: 5, maghrib_base: 18, min_shift: 1 },
        { id:11, name: "–ë–∞–∫—É", fajr_base: 6, maghrib_base: 18, min_shift: 1 },
        { id:12, name: "–°—Ç–∞–º–±—É–ª", fajr_base: 6, maghrib_base: 18, min_shift: 1 },
        { id:13, name: "–î—É–±–∞–π", fajr_base: 5, maghrib_base: 18, min_shift: 0 },
        { id:14, name: "–ú–µ–∫–∫–∞", fajr_base: 5, maghrib_base: 18, min_shift: 0 },
        { id:15, name: "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥", fajr_base: 6, maghrib_base: 17, min_shift: 3 }
    ];

    const today = new Date();
    const ramadanStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    
    function getCurrentDay() {
        const now = new Date();
        const startZero = new Date(ramadanStart);
        const nowZero = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        const diff = nowZero - startZero;
        let day = Math.ceil(diff / (1000 * 60 * 60 * 24)) + 1;
        return day > 30 ? 30 : day;
    }

    let realDayNum = getCurrentDay();
    let activeDayNum = realDayNum;
    let fullHistory = {};

    function initApp() {
        const key = 'ramadan_v18_final';
        try {
            if (tg && tg.CloudStorage) {
                tg.CloudStorage.getItem(key, (err, val) => {
                    if (!err && val) { 
                        try { fullHistory = JSON.parse(val); document.getElementById('syncStatus').innerText = "‚òÅÔ∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ"; }
                        catch(e) { fullHistory = {}; }
                    } else { 
                        document.getElementById('syncStatus').innerText = "‚ú® –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ"; 
                    }
                    renderDay(activeDayNum);
                });
            } else {
                const loc = localStorage.getItem(key);
                if(loc) fullHistory = JSON.parse(loc);
                renderDay(activeDayNum);
            }
        } catch(e) { renderDay(activeDayNum); }
    }

    function renderDay(dayNum) {
        document.getElementById('uiDayNum').innerText = dayNum;
        document.getElementById('prevDay').classList.toggle('disabled', dayNum <= 1);
        document.getElementById('nextDay').classList.toggle('disabled', dayNum >= realDayNum);
        
        const data = fullHistory[dayNum] || { tasks: {}, customText: "", rating: 0, thoughts: "" };
        
        document.querySelectorAll('.task-item').forEach(el => el.classList.remove('checked'));
        for(const [id, done] of Object.entries(data.tasks)) {
            if(done) document.querySelectorAll(`[onclick*="'${id}'"]`).forEach(el => el.classList.add('checked'));
        }
        
        document.getElementById('customInput').value = data.customText || "";
        document.getElementById('dailyThoughts').value = data.thoughts || "";

        const r = data.rating || 0;
        document.querySelectorAll('.star').forEach(s => s.classList.toggle('active', parseInt(s.dataset.val) <= r));

        document.querySelectorAll('.tracker-section').forEach(updateSectionProgress);
        updateDailyCircle();
    }

    function updateSectionProgress(section) {
        const total = section.querySelectorAll('.task-item').length;
        if(total === 0) return; 
        const checked = section.querySelectorAll('.task-item.checked').length;
        const percent = Math.round((checked / total) * 100);
        const fill = section.querySelector('.progress-bar-fill');
        const text = section.querySelector('.section-percent');
        if(fill && text) {
            fill.style.width = percent + "%";
            text.innerText = percent + "%";
            fill.style.backgroundColor = (percent === 100) ? "#27ae60" : "#d4af37";
        }
    }

    function updateDailyCircle() {
        let total = 0, checked = 0;
        document.querySelectorAll('.task-item').forEach(el => {
            total++;
            if(el.classList.contains('checked')) checked++;
        });
        
        const percent = total === 0 ? 0 : checked / total;
        const offset = 440 - (percent * 440);
        const circle = document.getElementById('monthCircle');
        
        circle.style.strokeDashoffset = offset;
        
        if(percent < 0.3) circle.style.stroke = "#e74c3c"; 
        else if(percent < 1) circle.style.stroke = "#d4af37"; 
        else circle.style.stroke = "#27ae60"; 
    }

    document.getElementById('prevDay').addEventListener('click', () => { if(activeDayNum>1){activeDayNum--; renderDay(activeDayNum); haptic();} });
    document.getElementById('nextDay').addEventListener('click', () => { if(activeDayNum<realDayNum){activeDayNum++; renderDay(activeDayNum); haptic();} });
    window.toggleTask = function(el, id) { 
        el.classList.toggle('checked'); ensureDayObj(activeDayNum); 
        fullHistory[activeDayNum].tasks[id] = el.classList.contains('checked'); 
        updateSectionProgress(el.closest('.tracker-section'));
        updateDailyCircle(); 
        saveData(); haptic(); 
    }
    window.saveCustomText = function() { ensureDayObj(activeDayNum); fullHistory[activeDayNum].customText = document.getElementById('customInput').value; clearTimeout(window.st); window.st = setTimeout(saveData, 500); }
    window.saveThoughts = function() { ensureDayObj(activeDayNum); fullHistory[activeDayNum].thoughts = document.getElementById('dailyThoughts').value; clearTimeout(window.st); window.st = setTimeout(saveData, 500); }
    document.querySelectorAll('.star').forEach(s => s.addEventListener('click', function() { ensureDayObj(activeDayNum); fullHistory[activeDayNum].rating = parseInt(this.dataset.val); renderDay(activeDayNum); saveData(); haptic(); }));

    function ensureDayObj(d){ if(!fullHistory[d]) fullHistory[d] = {tasks:{}, customText:"", rating:0, thoughts:""}; }
    function saveData(){
        const val = JSON.stringify(fullHistory);
        const status = document.getElementById('syncStatus');
        status.innerText = "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...";
        const key = 'ramadan_v18_final';
        const cb = (e) => {
            if(!e) { status.innerText = "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ"; status.classList.add('active'); setTimeout(() => status.classList.remove('active'), 1000); }
        };
        if(tg && tg.CloudStorage) tg.CloudStorage.setItem(key, val, cb);
        else { localStorage.setItem(key, val); cb(null); }
    }
    function haptic(){ if(tg && tg.HapticFeedback) tg.HapticFeedback.selectionChanged(); }
    window.closeModal = function(id){ document.getElementById(id).classList.remove('show'); }

    // === –õ–û–ì–ò–ö–ê SHARE ===
    document.getElementById('btnShare').addEventListener('click', () => {
        const d = fullHistory[activeDayNum] || {};
        const rating = d.rating || 0;
        
        const date = new Date(ramadanStart);
        date.setDate(ramadanStart.getDate() + (activeDayNum - 1));
        document.getElementById('shareDate').innerText = date.toLocaleDateString('ru-RU', {day:'numeric', month:'long'});
        document.getElementById('shareDayNum').innerText = activeDayNum;
        
        let total = 0, checked = 0;
        document.querySelectorAll('.task-item').forEach(el => { total++; if(el.classList.contains('checked')) checked++; });
        const percent = total ? checked/total : 0;
        
        const circle = document.getElementById('shareCircle');
        circle.style.strokeDashoffset = 440 - (percent * 440);
        if(percent < 0.3) circle.style.stroke = "#e74c3c";
        else if(percent < 1) circle.style.stroke = "#d4af37";
        else circle.style.stroke = "#27ae60";

        let starsHtml = '';
        for(let i=1; i<=5; i++) { starsHtml += `<span style="font-size:24px; color:${i<=rating ? '#d4af37' : '#333'}">‚òÖ</span>`; }
        document.getElementById('shareStars').innerHTML = starsHtml;

        let aiMsg = "–î–µ–Ω—å –ø—Ä–æ—à–µ–ª. –ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ ‚Äî –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É.";
        if(rating === 5) aiMsg = "üî• –ú–∞—à–∞–ê–ª–ª–∞—Ö! –ò–¥–µ–∞–ª—å–Ω—ã–π –¥–µ–Ω—å. –¢—ã –≤—ã–∂–∞–ª –∏–∑ –Ω–µ–≥–æ –º–∞–∫—Å–∏–º—É–º.";
        else if(rating >= 4) aiMsg = "üí™ –•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞. –ß—É—Ç—å-—á—É—Ç—å –ø–æ–¥–Ω–∞–∂–∞—Ç—å ‚Äî –∏ –±—É–¥–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ.";
        else if(rating > 0 && rating < 3) aiMsg = "–ù–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è. –ó–∞–≤—Ç—Ä–∞ –±—É–¥–µ—Ç –ª—É—á—à–µ.";
        document.getElementById('shareAiText').innerText = aiMsg;
        
        // –°–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        document.getElementById('shareCardToRender').style.display = 'block';
        document.getElementById('generatedImageContainer').style.display = 'none';
        document.getElementById('generatedImageContainer').innerHTML = '';
        document.getElementById('btnGenImage').innerText = "–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É";
        document.getElementById('shareHint').innerText = "–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–æ—Ç–æ";

        document.getElementById('modalShare').classList.add('show');
    });

    // === –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–ê–†–¢–ò–ù–ö–ò ===
    window.generateAndSend = function() {
        const btn = document.getElementById('btnGenImage');
        const hint = document.getElementById('shareHint');
        const element = document.getElementById('shareCardToRender');
        
        if (btn.innerText.includes("–ì–æ—Ç–æ–≤–æ")) {
            // –ï—Å–ª–∏ —É–∂–µ –≥–æ—Ç–æ–≤–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º
            hint.style.color = "#d4af37";
            hint.innerText = "–î–æ–ª–≥–∏–π —Ç–∞–ø –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ ‚¨ÜÔ∏è, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å.";
            return;
        }

        btn.innerText = "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...";
        
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–ø—Ü–∏–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã
        html2canvas(element, { 
            backgroundColor: null,
            scale: 2, // –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
            useCORS: true, // –†–∞–∑—Ä–µ—à–∞–µ–º –≤–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã
            allowTaint: true
        }).then(canvas => {
            try {
                const imgData = canvas.toDataURL("image/png");
                const img = document.createElement('img');
                img.src = imgData;
                
                const cont = document.getElementById('generatedImageContainer');
                cont.innerHTML = '';
                cont.appendChild(img);
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                element.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º HTML
                cont.style.display = 'block';   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É
                
                btn.innerText = "–ì–æ—Ç–æ–≤–æ (–ñ–º–∏ –Ω–∞ —Ñ–æ—Ç–æ)";
                hint.innerText = "–ó–∞–∂–º–∏ —Ñ–æ—Ç–æ –ø–∞–ª—å—Ü–µ–º, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –µ–≥–æ.";
                haptic();
            } catch (e) {
                alert("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —ç–∫—Ä–∞–Ω–∞.");
                btn.innerText = "–û—à–∏–±–∫–∞";
            }
        }).catch(err => {
            console.error(err);
            alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç.");
            btn.innerText = "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞";
        });
    }

    // === –ö–ê–õ–ï–ù–î–ê–†–¨ ===
    let savedCityId = localStorage.getItem('ramadan_city_id_v14');
    document.getElementById('btnCalendar').addEventListener('click', () => {
        const container = document.getElementById('calContent');
        if (savedCityId === null) { renderCitySelector(container); document.getElementById('calTitle').innerText="üìç –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥"; }
        else { renderCalendar(container, CITIES[savedCityId]); document.getElementById('calTitle').innerText=`üìÖ ${CITIES[savedCityId].name}`; }
        document.getElementById('modalCalendar').classList.add('show');
    });
    function renderCitySelector(c){ 
        let h='<div class="city-list">'; 
        CITIES.forEach((x,i)=>{h+=`<div class="city-item" onclick="selectCity(${i})"><span class="city-name">${x.name}</span></div>`}); 
        c.innerHTML=h+'</div>'; 
    }
    window.selectCity=function(i){ savedCityId=i; localStorage.setItem('ramadan_city_id_v14',i); renderCalendar(document.getElementById('calContent'), CITIES[i]); document.getElementById('calTitle').innerText=`üìÖ ${CITIES[i].name}`; }
    window.changeCity=function(){ savedCityId=null; localStorage.removeItem('ramadan_city_id_v14'); renderCitySelector(document.getElementById('calContent')); document.getElementById('calTitle').innerText="üìç –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥"; }
    
    function renderCalendar(c,city){
        let h=`<div class="cal-disclaimer">‚ö†Ô∏è –í—Ä–µ–º—è —É–∫–∞–∑–∞–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ.</div><div class="prayer-table-container"><table class="prayer-table"><thead><tr><th>–î</th><th>–§–∞–¥–∂—Ä</th><th>–ó—É—Ö—Ä</th><th>–ê—Å—Ä</th><th>–ú–∞–≥—Ä–∏–±</th><th>–ò—à–∞</th></tr></thead><tbody>`;
        for(let i=0; i<30; i++){
            let shift=city.min_shift*i; 
            let fM=30-shift, mM=10+shift, fH=city.fajr_base, mH=city.maghrib_base;
            while(fM<0){fM+=60;fH--} while(mM>=60){mM-=60;mH++}
            let isT=(i+1)===activeDayNum?'class="today-row"':'';
            h+=`<tr ${isT}><td>${i+1}</td><td style="font-weight:700;color:#fff">${fH}:${fM<10?'0'+fM:fM}</td><td>12:30</td><td>15:${20+i}</td><td style="font-weight:700;color:#d4af37">${mH}:${mM<10?'0'+mM:mM}</td><td>${mH+1}:${mM<10?'0'+mM:mM}</td></tr>`;
        }
        c.innerHTML=h+`</tbody></table></div><button class="change-city-btn" onclick="changeCity()">üìç –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</button>`;
    }

    // === –û–¢–ß–ï–¢ ===
    document.getElementById('btnStats').addEventListener('click', () => {
        let d=0, r=0, q=0, n=0;
        for(const k in fullHistory){ const x=fullHistory[k]; if(x.rating>0||Object.keys(x.tasks).length>0){d++;r+=x.rating; if(x.tasks.quran_read)q++; if(x.tasks.fajr&&x.tasks.dhuhr&&x.tasks.asr&&x.tasks.maghrib&&x.tasks.isha)n++;}}
        document.getElementById('statDays').innerText=d; document.getElementById('statRating').innerText=d>0?(r/d).toFixed(1):"0.0";
        document.getElementById('statQuran').innerText=q; document.getElementById('statNamaz').innerText=n;
        
        const ai = document.getElementById('aiText');
        if(d===0) ai.innerText="–î–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞ –Ω–µ—Ç.";
        else if(n<d) {ai.innerText="‚ö†Ô∏è –ü–æ–¥—Ç—è–Ω–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–º–∞–∑—ã!"; ai.style.color="#e74c3c";}
        else if(r/d >= 4.5) {ai.innerText="üî• –ò–¥–µ–∞–ª—å–Ω—ã–π —Ç–µ–º–ø! –ú–∞—à–∞–ê–ª–ª–∞—Ö."; ai.style.color="#27ae60";}
        else {ai.innerText="üí™ –•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞. –ù–µ —Å–±–∞–≤–ª—è–π –æ–±–æ—Ä–æ—Ç—ã."; ai.style.color="#d4af37";}

        document.getElementById('modalStats').classList.add('show');
    });

    // === –ö–ù–û–ü–ö–ê –°–û–•–†–ê–ù–ò–¢–¨ (–ò–°–ü–†–ê–í–õ–ï–ù–ê –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø) ===
    document.getElementById('btnFinish').addEventListener('click', function() { 
        saveData(); 
        
        // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        const btn = this;
        const originalText = btn.innerText;
        btn.innerText = "–°–û–•–†–ê–ù–ï–ù–û!";
        btn.classList.add('saved');
        
        // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–ª–µ–≥—Ä–∞–º, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ä–∞–∑—É, —á—Ç–æ–±—ã —é–∑–µ—Ä –≤–∏–¥–µ–ª —É—Å–ø–µ—Ö
        if(tg && tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');
        
        setTimeout(() => {
            btn.innerText = originalText;
            btn.classList.remove('saved');
        }, 2000);
    });

    initApp();
</script>
</body>
</html>
